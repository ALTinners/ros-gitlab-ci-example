stages:
  - build
  - integration_test
  - acceptance_test
  - cleanup

before_script:
  - source source_ros.bash
  - source $ROS_SOURCE_BASH_FILE
  - ./roscore_kill.bash
  - nohup roscore & disown

building:
  stage: build
  script: 
    - echo "Building..."
    - catkin_make run_tests
    - xsltproc -o unit_tests.html gtest-result.xsl build/test_results/primary/gtest-primary_controller_unit_tests.xml
  artifacts:
    paths:
    - unit_tests.html
    expire_in: 1 week

integration_testing:
  stage: integration_test
  script: echo "Integration Testing..."

acceptance_testing:
  stage: acceptance_test
  script: echo "Acceptance Testing..."

pages:
  stage: cleanup
  script:
    - mkdir public
    - mv unit_tests.html public
  artifacts:
    paths:
      - public

after_script:
  - ./roscore_kill.bash
